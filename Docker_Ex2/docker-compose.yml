version: '3.9'


services:
    api:
      build:
        context: ./node_api #Onde está nossa aplicação 
        dockerfile: Dockerfile 
      container_name: servico_api_node 
      environment:
          BD_HOST: ${BD_HOST}
          BD_USER: ${BD_USER}
          BD_SENHA: ${BD_SENHA}
          BD_NOME: ${BD_NOME}
          PORTA: ${PORTA}
      depends_on:
        - db

    db:
      image: postgres:15
      env_file:
          - .env 
      environment:
        POSTGRES_USER: ${BD_USER} 
        POSTGRES_PASSWORD: ${BD_SENHA}
        POSTGRES_DB: ${BD_NOME}
      ports:  
        - "5438:5432"
      volumes:
        - pgdata:/var/lib/postgresql/data

volumes:
    pgdata: 
